{"ast":null,"code":"var _jsxFileName = \"/home/mvt/Desktop/projects/mern-stack/e-commerce/client/src/components/Product-Reviews/product-reviews-overview/product-reviews-overview.component.jsx\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport AppContext from \"../../../context/app-viewport.context\";\nimport { ProductReviewsOverviewWrapper, Row, Grid, Image, TextArea, CompleteReview } from \"./product-reviews-overview.styles\";\nimport { selectProductReviewsItem } from \"../../../redux/product-reviews/product-reviews.selectors\";\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport { Link } from \"react-router-dom\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport Button from \"@material-ui/core/Button\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport Loader from \"../../UI/loader/loader.component\";\nimport { postReviewsProduct, updateReviewsProduct } from \"../../../utils/connectDB\";\nimport { withRouter } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    verticalAlign: \"middle\"\n  }\n}));\n\nconst ProductReviewsOverview = ({\n  productReviews,\n  history\n}) => {\n  const classes = useStyles();\n  const [stars, setStars] = useState(0);\n  const [comment, setComment] = useState(\"\");\n  const [completeReview, setCompleteReview] = useState(false);\n  useEffect(() => {\n    console.log(productReviews);\n\n    if (productReviews.my_vote_review) {\n      setStars(productReviews.my_vote_review.value);\n    }\n\n    if (productReviews.my_comment_review) {\n      setComment(productReviews.my_comment_review.text);\n    }\n  }, [productReviews]);\n  const [mobileView, setMobileView] = useState(window.innerWidth < 600);\n  const [tabletView, setTabletView] = useState(window.innerWidth < 992 && window.innerWidth >= 600);\n  const [loading, setLoading] = useState(false);\n  const [disabled, setDisabled] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    if (!comment && !stars) {\n      setDisabled(true);\n    } else {\n      setDisabled(false);\n    }\n  }, [comment, stars]);\n  const width = useContext(AppContext);\n  useEffect(() => {\n    if (width < 600) {\n      setMobileView(true);\n    } else {\n      setMobileView(false);\n    }\n\n    if (width < 992 && width >= 600) {\n      setTabletView(true);\n    } else {\n      setTabletView(false);\n    }\n  }, [width]);\n\n  const handleSendReviews = () => {\n    setLoading(true); //if user has review, update product\n\n    if (productReviews.my_vote_review || productReviews.my_comment_review) {\n      let updatedMyReview = {};\n\n      if (productReviews.my_comment_review) {\n        updatedMyReview.updatedComment = { ...productReviews.my_comment_review\n        };\n      }\n\n      if (productReviews.my_vote_review) {\n        updatedMyReview.updatedVote = { ...productReviews.my_vote_review\n        };\n      }\n\n      updateReviewsProduct(productReviews._id, stars, comment, updatedMyReview).then(data => {\n        setCompleteReview(true);\n      }).catch(err => {\n        setError(err);\n      });\n    } else {\n      postReviewsProduct(productReviews._id, stars, comment).then(data => {\n        setCompleteReview(true);\n      }).catch(err => {\n        setError(err);\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(ProductReviewsOverviewWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }\n  }, completeReview ? /*#__PURE__*/React.createElement(CompleteReview, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, \"C\\xE1m \\u01A1n b\\u1EA1n s\\u1EF1 \\u0111\\xF3ng g\\xF3p c\\u1EE7a b\\u1EA1n v\\u1EC1 s\\u1EA3n ph\\u1EA9m.\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    startIcon: /*#__PURE__*/React.createElement(HomeIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 24\n      }\n    }),\n    onClick: () => history.push(\"/\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 11\n    }\n  }, \"Trang ch\\u1EE7\")) : /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, loading ? /*#__PURE__*/React.createElement(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }, error ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: \"center\",\n      margin: \"1.5rem auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"h4\", {\n    style: {\n      color: \"#dd2222\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 19\n    }\n  }, error)) : null, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    width: 25,\n    mobileView: mobileView,\n    tabletView: tabletView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: `data:${productReviews.images[0].mimetype};base64,${productReviews.images[0].data}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    witdh: 75,\n    mobileView: mobileView,\n    tabletView: tabletView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 19\n    }\n  }, productReviews.name), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 19\n    }\n  }, \"Ng\\u01B0\\u1EDDi \\u0111\\u0103ng SP :\", \" \", /*#__PURE__*/React.createElement(Link, {\n    to: `/user/${productReviews.user._id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 21\n    }\n  }, `${productReviews.user.information.first_name} ${productReviews.user.information.last_name}`)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 19\n    }\n  }, \"Ng\\xE0y \\u0111\\u0103ng :\", \" \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  }, new Date(productReviews.createdAt).toLocaleString())), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 19\n    }\n  }, \"\\u0110\\xE1nh gi\\xE1 t\\u1EEB ng\\u01B0\\u1EDDi d\\xF9ng :\", \" \", productReviews.stars ? /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Rating, {\n    name: \"read-only\",\n    value: productReviews.stars,\n    readOnly: true,\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: \"#909090\",\n      fontSize: \"0.9em\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 25\n    }\n  }, \"(\", productReviews.numberOfVotes, \" \\u0111\\xE1nh gi\\xE1)\")) : /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: \"#dd2222\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 23\n    }\n  }, \"Ch\\u01B0a c\\xF3 \\u0111\\xE1nh gi\\xE1\")), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `${productReviews.linkUrl}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 21\n    }\n  }, \"Chi ti\\u1EBFt s\\u1EA3n ph\\u1EA9m\")))), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      flexDirection: \"column\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  }, \"\\u0110\\xE1nh gi\\xE1 s\\u1EA3n ph\\u1EA9m\"), /*#__PURE__*/React.createElement(Rating, {\n    name: \"half-rating\",\n    value: +stars,\n    precision: 0.5,\n    onChange: e => setStars(e.target.value < 1 ? 1 : e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(TextArea, {\n    placeholder: \"\\u0110\\xF3ng g\\xF3p c\\u1EE7a b\\u1EA1n v\\u1EC1 s\\u1EA3n ph\\u1EA9m\",\n    onChange: e => setComment(e.target.value),\n    value: comment,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    style: {\n      display: \"inline-block\"\n    },\n    disabled: disabled,\n    onClick: handleSendReviews,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 17\n    }\n  }, \"G\\u1EEDi \\u0111\\xE1nh gi\\xE1\")))));\n};\n\nconst mapStateToProps = createStructuredSelector({\n  productReviews: selectProductReviewsItem\n});\nexport default connect(mapStateToProps)(withRouter(ProductReviewsOverview));","map":{"version":3,"sources":["/home/mvt/Desktop/projects/mern-stack/e-commerce/client/src/components/Product-Reviews/product-reviews-overview/product-reviews-overview.component.jsx"],"names":["React","useState","useContext","useEffect","AppContext","ProductReviewsOverviewWrapper","Row","Grid","Image","TextArea","CompleteReview","selectProductReviewsItem","connect","createStructuredSelector","Link","Rating","Button","HomeIcon","Loader","postReviewsProduct","updateReviewsProduct","withRouter","makeStyles","useStyles","theme","root","verticalAlign","ProductReviewsOverview","productReviews","history","classes","stars","setStars","comment","setComment","completeReview","setCompleteReview","console","log","my_vote_review","value","my_comment_review","text","mobileView","setMobileView","window","innerWidth","tabletView","setTabletView","loading","setLoading","disabled","setDisabled","error","setError","width","handleSendReviews","updatedMyReview","updatedComment","updatedVote","_id","then","data","catch","err","push","textAlign","margin","color","images","mimetype","name","user","information","first_name","last_name","Date","createdAt","toLocaleString","fontSize","numberOfVotes","linkUrl","flexDirection","e","target","display","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport AppContext from \"../../../context/app-viewport.context\";\nimport {\n  ProductReviewsOverviewWrapper,\n  Row,\n  Grid,\n  Image,\n  TextArea,\n  CompleteReview,\n} from \"./product-reviews-overview.styles\";\nimport { selectProductReviewsItem } from \"../../../redux/product-reviews/product-reviews.selectors\";\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport { Link } from \"react-router-dom\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport Button from \"@material-ui/core/Button\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport Loader from \"../../UI/loader/loader.component\";\nimport {\n  postReviewsProduct,\n  updateReviewsProduct,\n} from \"../../../utils/connectDB\";\nimport { withRouter } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    verticalAlign: \"middle\",\n  },\n}));\nconst ProductReviewsOverview = ({ productReviews, history }) => {\n  const classes = useStyles();\n  const [stars, setStars] = useState(0);\n  const [comment, setComment] = useState(\"\");\n  const [completeReview, setCompleteReview] = useState(false);\n  useEffect(() => {\n    console.log(productReviews);\n    if (productReviews.my_vote_review) {\n      setStars(productReviews.my_vote_review.value);\n    }\n    if (productReviews.my_comment_review) {\n      setComment(productReviews.my_comment_review.text);\n    }\n  }, [productReviews]);\n  const [mobileView, setMobileView] = useState(window.innerWidth < 600);\n  const [tabletView, setTabletView] = useState(\n    window.innerWidth < 992 && window.innerWidth >= 600\n  );\n  const [loading, setLoading] = useState(false);\n  const [disabled, setDisabled] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    if (!comment && !stars) {\n      setDisabled(true);\n    } else {\n      setDisabled(false);\n    }\n  }, [comment, stars]);\n  const width = useContext(AppContext);\n  useEffect(() => {\n    if (width < 600) {\n      setMobileView(true);\n    } else {\n      setMobileView(false);\n    }\n    if (width < 992 && width >= 600) {\n      setTabletView(true);\n    } else {\n      setTabletView(false);\n    }\n  }, [width]);\n\n  const handleSendReviews = () => {\n    setLoading(true);\n    //if user has review, update product\n    if (productReviews.my_vote_review || productReviews.my_comment_review) {\n      let updatedMyReview = {};\n      if (productReviews.my_comment_review) {\n        updatedMyReview.updatedComment = {\n          ...productReviews.my_comment_review,\n        };\n      }\n      if (productReviews.my_vote_review) {\n        updatedMyReview.updatedVote = { ...productReviews.my_vote_review };\n      }\n      updateReviewsProduct(productReviews._id, stars, comment, updatedMyReview)\n        .then((data) => {\n          setCompleteReview(true);\n        })\n        .catch((err) => {\n          setError(err);\n        });\n    } else {\n      postReviewsProduct(productReviews._id, stars, comment)\n        .then((data) => {\n          setCompleteReview(true);\n        })\n        .catch((err) => {\n          setError(err);\n        });\n    }\n  };\n  return (\n    <ProductReviewsOverviewWrapper>\n      {completeReview ? (\n        <CompleteReview>\n          <h3>Cám ơn bạn sự đóng góp của bạn về sản phẩm.</h3>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={<HomeIcon />}\n            onClick={() => history.push(\"/\")}\n          >\n            Trang chủ\n          </Button>\n        </CompleteReview>\n      ) : (\n        <React.Fragment>\n          {loading ? (\n            <Loader />\n          ) : (\n            <React.Fragment>\n              {error ? (\n                <div style={{ textAlign: \"center\", margin: \"1.5rem auto\" }}>\n                  {\" \"}\n                  <h4 style={{ color: \"#dd2222\" }}>{error}</h4>\n                </div>\n              ) : null}\n              <Row>\n                <Grid\n                  width={25}\n                  mobileView={mobileView}\n                  tabletView={tabletView}\n                >\n                  <Image\n                    src={`data:${productReviews.images[0].mimetype};base64,${productReviews.images[0].data}`}\n                  />\n                </Grid>\n                <Grid\n                  witdh={75}\n                  mobileView={mobileView}\n                  tabletView={tabletView}\n                >\n                  <h3>{productReviews.name}</h3>\n                  <p>\n                    Người đăng SP :{\" \"}\n                    <Link\n                      to={`/user/${productReviews.user._id}`}\n                    >{`${productReviews.user.information.first_name} ${productReviews.user.information.last_name}`}</Link>\n                  </p>\n                  <p>\n                    Ngày đăng :{\" \"}\n                    <span>\n                      {new Date(productReviews.createdAt).toLocaleString()}\n                    </span>\n                  </p>\n                  <p>\n                    Đánh giá từ người dùng :{\" \"}\n                    {productReviews.stars ? (\n                      <React.Fragment>\n                        <Rating\n                          name=\"read-only\"\n                          value={productReviews.stars}\n                          readOnly\n                          className={classes.root}\n                        />\n                        <span style={{color : \"#909090\" , fontSize: \"0.9em\"}}>({productReviews.numberOfVotes} đánh giá)</span>\n                      </React.Fragment>\n                    ) : (\n                      <span style={{ color: \"#dd2222\" }}>Chưa có đánh giá</span>\n                    )}\n                  </p>\n                  <p>\n                    <Link to={`${productReviews.linkUrl}`}>\n                      Chi tiết sản phẩm\n                    </Link>\n                  </p>\n                </Grid>\n              </Row>\n              <Row style={{ flexDirection: \"column\" }}>\n                <h3>Đánh giá sản phẩm</h3>\n                <Rating\n                  name=\"half-rating\"\n                  value={+stars}\n                  precision={0.5}\n                  onChange={(e) =>\n                    setStars(e.target.value < 1 ? 1 : e.target.value)\n                  }\n                />\n                <TextArea\n                  placeholder=\"Đóng góp của bạn về sản phẩm\"\n                  onChange={(e) => setComment(e.target.value)}\n                  value={comment}\n                />\n              </Row>\n              <Row>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  style={{ display: \"inline-block\" }}\n                  disabled={disabled}\n                  onClick={handleSendReviews}\n                >\n                  Gửi đánh giá\n                </Button>\n              </Row>\n            </React.Fragment>\n          )}\n        </React.Fragment>\n      )}\n    </ProductReviewsOverviewWrapper>\n  );\n};\n\nconst mapStateToProps = createStructuredSelector({\n  productReviews: selectProductReviewsItem,\n});\nexport default connect(mapStateToProps)(withRouter(ProductReviewsOverview));\n"]},"metadata":{},"sourceType":"module"}