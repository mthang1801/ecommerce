{"ast":null,"code":"var _jsxFileName = \"/home/mvt/Desktop/projects/mern-stack/e-commerce/client/src/components/Product-Detail/comment-reviews/comment-reviews.component.jsx\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { getCommentReviewsByProductId } from \"../../../utils/connectDB\";\nimport Spinner from \"../../UI/spinner/spinner.component\";\nimport { CommentReviewsWrapper, TextArea, CommentsWrapper, ReadMore } from \"./comment-reviews.styles\";\nimport CommentReviewsItem from \"../comment-reviews-item/comment-reviews-item.component\";\nimport Button from \"@material-ui/core/Button\";\nimport { connect } from \"react-redux\";\nimport { selectCommentsLoading, selectComments, selectCommentReviewsError } from \"../../../redux/product-comment-review/product-comment-review.selectors\";\nimport { createStructuredSelector } from \"reselect\";\nimport { fetchProductCommentReview } from \"../../../redux/product-comment-review/product-comment-review.actions\";\n\nconst CommentReviews = ({\n  show,\n  productId,\n  comments,\n  loading,\n  error,\n  fetchProductCommentReview,\n  readMore,\n  setReadMore,\n  setTaskHeight\n}) => {\n  const commentsRef = useRef(null);\n  const [showReadMore, setShowReadMore] = useState(false);\n  useEffect(() => {\n    let _mounted = true;\n\n    if (productId) {\n      fetchProductCommentReview(productId);\n    }\n\n    return () => {\n      _mounted = false;\n    };\n  }, [productId]);\n  useEffect(() => {\n    if (commentsRef.current.scrollHeight > commentsRef.current.clientHeight) {\n      console.log(commentsRef.current.scrollHeight, commentsRef.current.clientHeight);\n      setShowReadMore(true);\n      setTaskHeight(commentsRef.current.scrollHeight);\n    }\n  }, [comments]);\n  return /*#__PURE__*/React.createElement(CommentReviewsWrapper, {\n    ref: commentsRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 5\n    }\n  }, loading ? /*#__PURE__*/React.createElement(Spinner, {\n    loadChildComponent: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CommentsPost, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TextArea, {\n    placeholder: \"\\u0110\\u1EC3 l\\u1EA1i b\\xECnh lu\\u1EADn c\\u1EE7a b\\u1EA1n t\\u1EA1i \\u0111\\xE2y\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    variant: \"contained\",\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 13\n    }\n  }, \"G\\u1EEDi\")), /*#__PURE__*/React.createElement(\"hr\", {\n    style: {\n      width: \"100%\",\n      margin: \"0.75rem 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(CommentsGet, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 11\n    }\n  }, comments.length ? comments.map(comment => {\n    return /*#__PURE__*/React.createElement(CommentReviewsItem, {\n      key: comment._id,\n      comment: comment,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 21\n      }\n    });\n  }) : null)), showReadMore ? /*#__PURE__*/React.createElement(ReadMore, {\n    onClick: () => setReadMore(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 25\n    }\n  }, !readMore ? \"Xem thêm\" : \"Thu gọn\") : null);\n};\n\nconst mapStateToProps = createStructuredSelector({\n  comments: selectComments,\n  loading: selectCommentsLoading,\n  error: selectCommentReviewsError\n});\n\nconst mapDispatchToProps = dispatch => ({\n  fetchProductCommentReview: productId => dispatch(fetchProductCommentReview(productId))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CommentReviews);","map":{"version":3,"sources":["/home/mvt/Desktop/projects/mern-stack/e-commerce/client/src/components/Product-Detail/comment-reviews/comment-reviews.component.jsx"],"names":["React","useEffect","useState","useRef","getCommentReviewsByProductId","Spinner","CommentReviewsWrapper","TextArea","CommentsWrapper","ReadMore","CommentReviewsItem","Button","connect","selectCommentsLoading","selectComments","selectCommentReviewsError","createStructuredSelector","fetchProductCommentReview","CommentReviews","show","productId","comments","loading","error","readMore","setReadMore","setTaskHeight","commentsRef","showReadMore","setShowReadMore","_mounted","current","scrollHeight","clientHeight","console","log","width","margin","length","map","comment","_id","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { getCommentReviewsByProductId } from \"../../../utils/connectDB\";\nimport Spinner from \"../../UI/spinner/spinner.component\";\nimport {\n  CommentReviewsWrapper,\n  TextArea,\n  CommentsWrapper,\n  ReadMore\n} from \"./comment-reviews.styles\";\nimport CommentReviewsItem from \"../comment-reviews-item/comment-reviews-item.component\";\nimport Button from \"@material-ui/core/Button\";\nimport {connect} from \"react-redux\";\nimport {selectCommentsLoading, selectComments, selectCommentReviewsError} from \"../../../redux/product-comment-review/product-comment-review.selectors\"\nimport {createStructuredSelector} from \"reselect\"\nimport {fetchProductCommentReview} from \"../../../redux/product-comment-review/product-comment-review.actions\"\nconst CommentReviews = ({ show, productId, comments, loading, error, fetchProductCommentReview, readMore, setReadMore, setTaskHeight }) => {    \n  const commentsRef = useRef(null);\n  const [showReadMore, setShowReadMore] = useState(false);\n  useEffect(() => {\n    let _mounted = true;\n    if (productId) {\n      fetchProductCommentReview(productId)\n    }\n    return () => {\n      _mounted = false;\n    };\n  }, [productId]);\n  useEffect(() => {\n    if(commentsRef.current.scrollHeight > commentsRef.current.clientHeight ){\n      console.log(commentsRef.current.scrollHeight, commentsRef.current.clientHeight )\n      setShowReadMore(true);    \n      setTaskHeight(commentsRef.current.scrollHeight)\n     }\n  },[comments])\n  return (\n    <CommentReviewsWrapper ref={commentsRef}>\n      {loading ? (\n        <Spinner loadChildComponent />\n      ) : (\n        <React.Fragment>\n          <CommentsPost>\n            <TextArea placeholder=\"Để lại bình luận của bạn tại đây\" />\n            <Button color=\"primary\" variant=\"contained\" size=\"small\">\n              Gửi\n            </Button>\n          </CommentsPost>\n          <hr style={{width:\"100%\", margin : \"0.75rem 0\"}}/>\n          <CommentsGet>\n            {comments.length ? comments.map((comment) => {                \n                  return (\n                    <CommentReviewsItem key={comment._id} comment={comment} />\n                  );\n                })\n               : null }\n          </CommentsGet>\n        </React.Fragment>\n      )}\n       {showReadMore  ? <ReadMore onClick={() => setReadMore(true)}>{!readMore ? \"Xem thêm\" : \"Thu gọn\"}</ReadMore> : null} \n    </CommentReviewsWrapper>\n  );\n};\n\nconst mapStateToProps = createStructuredSelector({\n  comments : selectComments,\n  loading : selectCommentsLoading,\n  error : selectCommentReviewsError\n})\nconst mapDispatchToProps = dispatch => ({\n  fetchProductCommentReview : (productId) => dispatch(fetchProductCommentReview(productId))\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(CommentReviews);\n"]},"metadata":{},"sourceType":"module"}