{"ast":null,"code":"var _jsxFileName = \"/home/mvt/Desktop/projects/mern-stack/e-commerce/client/src/components/Product-Detail/comment-reviews-item/comment-reviews-item.component.jsx\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { CommentReviewsItemWrapper, Image, Row, ReadMore, CommentText, ButtonLink, TextArea } from \"./comment-reviews-item.styles\";\nimport Moment from \"react-moment\";\nimport { FcBusinessman } from \"react-icons/fc\";\nimport { connect } from \"react-redux\";\nimport { selectCurrentUser } from \"../../../redux/user/user.selectors\";\nimport { createStructuredSelector } from \"reselect\";\nimport { withRouter, Redirect, Link } from \"react-router-dom\";\nimport { AiOutlineLike, AiOutlineDislike } from \"react-icons/ai\";\nimport { postLikeOrUnlikeComment, postDislikeOrUnDislikeComment } from \"../../../utils/connectDB\";\nimport { setLikeForComment, setUnlikeForComment, setDislikeForComment, setUndislikeForComment } from \"../../../redux/product-comment-review/product-comment-review.actions\";\n\nconst CommentReviewsItem = ({\n  comment,\n  product,\n  setCommentItemHeight,\n  currentUser,\n  match,\n  history,\n  setLikeForComment,\n  setUnlikeForComment,\n  setDislikeForComment,\n  setUndislikeForComment\n}) => {\n  const commentItemReadMore = useRef(null);\n  const responseRef = useRef(null);\n  const [readMore, setReadMore] = useState(false);\n  const [showReadMore, setShowReadMore] = useState(false);\n  const [text, setText] = useState(\"\");\n  const [isResponseComment, setIsReponseComment] = useState(false);\n  useEffect(() => {\n    console.log(commentItemReadMore.current.scrollHeight, commentItemReadMore.current.clientHeight);\n\n    if (comment.text.length > 150) {\n      setShowReadMore(true);\n      setText(comment.text.substr(0, 200)); // setCommentItemHeight(commentItemReadMore.current.scrollHeight - )\n    } else {\n      setShowReadMore(false);\n      setText(comment.text);\n    }\n  }, [comment]);\n\n  const handleSetReadMore = () => {\n    if (readMore) {\n      setReadMore(false);\n      setText(comment.text.substr(0, 200));\n    } else {\n      setReadMore(true);\n      setText(comment.text);\n    }\n  };\n\n  const handleClickLikeButton = () => {\n    if (!currentUser) {\n      let splitUrl = match.url.split(\"/\");\n      splitUrl[splitUrl.length - 1] = encodeURIComponent(splitUrl[splitUrl.length - 1]);\n      const encodeUrl = splitUrl.join(\"/\");\n      return history.push({\n        pathname: \"/auth\",\n        state: {\n          from: encodeUrl\n        }\n      });\n    }\n\n    postLikeOrUnlikeComment(comment._id).then(msg => {\n      if (msg == \"like success\") {\n        setLikeForComment(comment._id, currentUser._id);\n      } else {\n        setUnlikeForComment(comment._id, currentUser._id);\n      }\n    }).catch(err => console.log(err));\n  };\n\n  const handleClickDislikeButton = () => {\n    if (!currentUser) {\n      let splitUrl = match.url.split(\"/\");\n      splitUrl[splitUrl.length - 1] = encodeURIComponent(splitUrl[splitUrl.length - 1]);\n      const encodeUrl = splitUrl.join(\"/\");\n      return history.push({\n        pathname: \"/auth\",\n        state: {\n          from: encodeUrl\n        }\n      });\n    }\n\n    postDislikeOrUnDislikeComment(comment._id).then(msg => {\n      if (msg == \"dislike success\") {\n        setDislikeForComment(comment._id, currentUser._id);\n      } else {\n        setUndislikeForComment(comment._id, currentUser._id);\n      }\n    }).catch(err => console.log(err));\n  };\n\n  const handleClickResponseCommentButton = () => {\n    setIsReponseComment(true);\n    responseRef.current.offsetTop();\n  };\n\n  return /*#__PURE__*/React.createElement(CommentReviewsItemWrapper, {\n    ref: commentItemReadMore,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: comment.user.avatar === \"avatar-default.png\" ? `http://localhost:5000/images/${comment.user.avatar}` : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      flexDirection: \"column\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CommentText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 15\n    }\n  }, comment.user.name, \" \", comment.user._id === product.user._id ? /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: \"#3f51b5\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 19\n    }\n  }, \"Nh\\xE0 b\\xE1n h\\xE0ng \", /*#__PURE__*/React.createElement(FcBusinessman, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 34\n    }\n  })) : \"\"), \" \", /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: \"rgba(0,0,0,0.75)\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Moment, {\n    format: \"DD-MM-YYYY HH:mm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, comment.updatedAt)), \" \"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, text, \" \", showReadMore ? /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }, \"...\", \" \", /*#__PURE__*/React.createElement(ReadMore, {\n    onClick: handleSetReadMore,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 19\n    }\n  }, !readMore ? \"Xem thêm\" : \"Thu gọn\")) : null, \" \")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ButtonLink, {\n    onClick: handleClickLikeButton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontSize: \"1em\",\n      verticalAlign: \"middle\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(AiOutlineLike, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  })), \" \", \"(\", comment.likes.length, \")\"), /*#__PURE__*/React.createElement(ButtonLink, {\n    onClick: handleClickDislikeButton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontSize: \"1em\",\n      verticalAlign: \"middle\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(AiOutlineDislike, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  })), \" \", \"(\", comment.dislikes.length, \")\"), /*#__PURE__*/React.createElement(ButtonLink, {\n    onClick: handleClickResponseCommentButton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }\n  }, \"Tr\\u1EA3 l\\u1EDDi\")), isResponseComment ? /*#__PURE__*/React.createElement(TextArea, {\n    ref: responseRef,\n    value: product.user.facebook.name || product.user.google.name || product.user.local.name + \",\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 32\n    }\n  }) : null)));\n};\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser\n});\n\nconst mapDispatchToProps = dispatch => ({\n  setLikeForComment: (commentId, userId) => dispatch(setLikeForComment(commentId, userId)),\n  setUnlikeForComment: (commentId, userId) => dispatch(setUnlikeForComment(commentId, userId)),\n  setDislikeForComment: (commentId, userId) => dispatch(setDislikeForComment(commentId, userId)),\n  setUndislikeForComment: (commentId, userId) => dispatch(setUndislikeForComment(commentId, userId))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(CommentReviewsItem));","map":{"version":3,"sources":["/home/mvt/Desktop/projects/mern-stack/e-commerce/client/src/components/Product-Detail/comment-reviews-item/comment-reviews-item.component.jsx"],"names":["React","useEffect","useState","useRef","CommentReviewsItemWrapper","Image","Row","ReadMore","CommentText","ButtonLink","TextArea","Moment","FcBusinessman","connect","selectCurrentUser","createStructuredSelector","withRouter","Redirect","Link","AiOutlineLike","AiOutlineDislike","postLikeOrUnlikeComment","postDislikeOrUnDislikeComment","setLikeForComment","setUnlikeForComment","setDislikeForComment","setUndislikeForComment","CommentReviewsItem","comment","product","setCommentItemHeight","currentUser","match","history","commentItemReadMore","responseRef","readMore","setReadMore","showReadMore","setShowReadMore","text","setText","isResponseComment","setIsReponseComment","console","log","current","scrollHeight","clientHeight","length","substr","handleSetReadMore","handleClickLikeButton","splitUrl","url","split","encodeURIComponent","encodeUrl","join","push","pathname","state","from","_id","then","msg","catch","err","handleClickDislikeButton","handleClickResponseCommentButton","offsetTop","user","avatar","flexDirection","name","color","updatedAt","fontSize","verticalAlign","likes","dislikes","facebook","google","local","mapStateToProps","mapDispatchToProps","dispatch","commentId","userId"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport {\n  CommentReviewsItemWrapper,\n  Image,\n  Row,\n  ReadMore,\n  CommentText,\n  ButtonLink,\n  TextArea\n} from \"./comment-reviews-item.styles\";\nimport Moment from \"react-moment\";\nimport { FcBusinessman } from \"react-icons/fc\";\nimport { connect } from \"react-redux\";\nimport { selectCurrentUser } from \"../../../redux/user/user.selectors\";\nimport { createStructuredSelector } from \"reselect\";\nimport { withRouter, Redirect, Link } from \"react-router-dom\";\nimport { AiOutlineLike, AiOutlineDislike } from \"react-icons/ai\";\nimport {postLikeOrUnlikeComment, postDislikeOrUnDislikeComment} from \"../../../utils/connectDB\"\nimport { setLikeForComment, setUnlikeForComment, setDislikeForComment, setUndislikeForComment} from \"../../../redux/product-comment-review/product-comment-review.actions\"\nconst CommentReviewsItem = ({\n  comment,\n  product,\n  setCommentItemHeight,\n  currentUser,\n  match,\n  history,\n  setLikeForComment,\n  setUnlikeForComment,\n  setDislikeForComment,\n  setUndislikeForComment\n}) => {\n  const commentItemReadMore = useRef(null);\n  const responseRef = useRef(null);\n  const [readMore, setReadMore] = useState(false);\n  const [showReadMore, setShowReadMore] = useState(false);\n  const [text, setText] = useState(\"\");\n  const [isResponseComment, setIsReponseComment] = useState(false);\n  useEffect(() => {\n    console.log(\n      commentItemReadMore.current.scrollHeight,\n      commentItemReadMore.current.clientHeight\n    );\n    if (comment.text.length > 150) {\n      setShowReadMore(true);\n      setText(comment.text.substr(0, 200));\n      // setCommentItemHeight(commentItemReadMore.current.scrollHeight - )\n    } else {\n      setShowReadMore(false);\n      setText(comment.text);\n    }\n  }, [comment]); \n  const handleSetReadMore = () => {\n    if (readMore) {\n      setReadMore(false);\n      setText(comment.text.substr(0, 200));\n    } else {\n      setReadMore(true);\n      setText(comment.text);\n    }\n  };\n  const handleClickLikeButton = () => {\n    if (!currentUser) {\n      let splitUrl = match.url.split(\"/\");\n      splitUrl[splitUrl.length - 1] = encodeURIComponent(\n        splitUrl[splitUrl.length - 1]\n      );\n      const encodeUrl = splitUrl.join(\"/\");\n      return history.push({ pathname: \"/auth\", state: { from: encodeUrl } });\n    }\n    postLikeOrUnlikeComment(comment._id)\n      .then((msg) => {\n        if(msg == \"like success\"){\n          setLikeForComment(comment._id, currentUser._id)\n        }else{\n          setUnlikeForComment(comment._id, currentUser._id)\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n  const handleClickDislikeButton = () => {\n    if (!currentUser) {\n      let splitUrl = match.url.split(\"/\");\n      splitUrl[splitUrl.length - 1] = encodeURIComponent(\n        splitUrl[splitUrl.length - 1]\n      );\n      const encodeUrl = splitUrl.join(\"/\");\n      return history.push({ pathname: \"/auth\", state: { from: encodeUrl } });\n    }\n    postDislikeOrUnDislikeComment(comment._id)\n      .then((msg) => {\n        if(msg == \"dislike success\"){\n          setDislikeForComment(comment._id, currentUser._id)\n        }else{\n          setUndislikeForComment(comment._id, currentUser._id)\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n  const handleClickResponseCommentButton = () => {\n    setIsReponseComment(true);\n    responseRef.current.offsetTop();\n  }\n  return (\n    <CommentReviewsItemWrapper ref={commentItemReadMore}>\n      <Row>\n        <Image\n          src={\n            comment.user.avatar === \"avatar-default.png\"\n              ? `http://localhost:5000/images/${comment.user.avatar}`\n              : null\n          }\n        />\n        <Row style={{ flexDirection: \"column\" }}>\n          <CommentText>\n            <p>\n              <strong>\n                {comment.user.name}{\" \"}\n                {comment.user._id === product.user._id ? (\n                  <span style={{ color: \"#3f51b5\" }}>\n                    Nhà bán hàng <FcBusinessman />\n                  </span>\n                ) : (\n                  \"\"\n                )}\n              </strong>{\" \"}\n              <span style={{ color: \"rgba(0,0,0,0.75)\" }}>\n                <Moment format=\"DD-MM-YYYY HH:mm\">{comment.updatedAt}</Moment>\n              </span>{\" \"}\n            </p>\n            <p>\n              {text}{\" \"}\n              {showReadMore ? (\n                <span>\n                  ...{\" \"}\n                  <ReadMore onClick={handleSetReadMore}>\n                    {!readMore ? \"Xem thêm\" : \"Thu gọn\"}\n                  </ReadMore>\n                </span>\n              ) : null}{\" \"}\n            </p>\n          </CommentText>\n          <div>\n            <ButtonLink onClick={handleClickLikeButton}>\n              <span style={{ fontSize: \"1em\", verticalAlign: \"middle\" }}>\n                <AiOutlineLike />\n              </span>{\" \"}\n              ({comment.likes.length})\n            </ButtonLink>\n            <ButtonLink onClick={handleClickDislikeButton}>\n              <span style={{ fontSize: \"1em\", verticalAlign: \"middle\" }}>\n                <AiOutlineDislike />\n              </span>{\" \"}\n              ({comment.dislikes.length})\n            </ButtonLink>\n            <ButtonLink onClick={handleClickResponseCommentButton}>Trả lời</ButtonLink>\n          </div>\n          {isResponseComment ? <TextArea  ref={responseRef} value={product.user.facebook.name || product.user.google.name || product.user.local.name + \",\"}/> : null}\n        </Row>        \n      </Row>\n     \n    </CommentReviewsItemWrapper>\n  );\n};\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n});\nconst mapDispatchToProps = dispatch => ({\n  setLikeForComment : (commentId, userId) => dispatch(setLikeForComment(commentId, userId)),\n  setUnlikeForComment : (commentId, userId) => dispatch(setUnlikeForComment(commentId, userId)),\n  setDislikeForComment : (commentId, userId) => dispatch(setDislikeForComment(commentId, userId)),\n  setUndislikeForComment : (commentId, userId) => dispatch(setUndislikeForComment(commentId, userId)),\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(CommentReviewsItem));\n"]},"metadata":{},"sourceType":"module"}